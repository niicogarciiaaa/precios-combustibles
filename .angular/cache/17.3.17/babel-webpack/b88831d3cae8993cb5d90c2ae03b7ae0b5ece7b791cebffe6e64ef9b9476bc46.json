{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class FavoritosService {\n  constructor() {\n    this.STORAGE_KEY = 'gasolineras_favoritos';\n    this.favoritos$ = new BehaviorSubject(this.cargarDelStorage());\n  }\n  /**\n   * Obtiene los favoritos como Observable\n   */\n  getFavoritos() {\n    return this.favoritos$.asObservable();\n  }\n  /**\n   * Obtiene los favoritos actuales de forma síncrona\n   */\n  getFavoritosActuales() {\n    return this.favoritos$.value;\n  }\n  /**\n   * Agrega una gasolinera a favoritos\n   */\n  agregarFavorito(gasolinera) {\n    const favoritos = this.favoritos$.value;\n    if (!this.esFavorito(gasolinera.id)) {\n      const nuevosFavoritos = [...favoritos, gasolinera];\n      this.favoritos$.next(nuevosFavoritos);\n      this.guardarEnStorage(nuevosFavoritos);\n    }\n  }\n  /**\n   * Elimina una gasolinera de favoritos\n   */\n  eliminarFavorito(id) {\n    const favoritos = this.favoritos$.value.filter(g => g.id !== id);\n    this.favoritos$.next(favoritos);\n    this.guardarEnStorage(favoritos);\n  }\n  /**\n   * Verifica si una gasolinera está en favoritos\n   */\n  esFavorito(id) {\n    return this.favoritos$.value.some(g => g.id === id);\n  }\n  /**\n   * Alterna el estado de favorito\n   */\n  toggleFavorito(gasolinera) {\n    if (this.esFavorito(gasolinera.id)) {\n      this.eliminarFavorito(gasolinera.id);\n    } else {\n      this.agregarFavorito(gasolinera);\n    }\n  }\n  /**\n   * Limpia todos los favoritos\n   */\n  limpiarFavoritos() {\n    this.favoritos$.next([]);\n    localStorage.removeItem(this.STORAGE_KEY);\n  }\n  /**\n   * Carga los favoritos del localStorage\n   */\n  cargarDelStorage() {\n    try {\n      const data = localStorage.getItem(this.STORAGE_KEY);\n      return data ? JSON.parse(data) : [];\n    } catch (error) {\n      console.error('Error al cargar favoritos del storage:', error);\n      return [];\n    }\n  }\n  /**\n   * Guarda los favoritos en localStorage\n   */\n  guardarEnStorage(favoritos) {\n    try {\n      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(favoritos));\n    } catch (error) {\n      console.error('Error al guardar favoritos en storage:', error);\n    }\n  }\n  static {\n    this.ɵfac = function FavoritosService_Factory(t) {\n      return new (t || FavoritosService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: FavoritosService,\n      factory: FavoritosService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","FavoritosService","constructor","STORAGE_KEY","favoritos$","cargarDelStorage","getFavoritos","asObservable","getFavoritosActuales","value","agregarFavorito","gasolinera","favoritos","esFavorito","id","nuevosFavoritos","next","guardarEnStorage","eliminarFavorito","filter","g","some","toggleFavorito","limpiarFavoritos","localStorage","removeItem","data","getItem","JSON","parse","error","console","setItem","stringify","factory","ɵfac","providedIn"],"sources":["/Users/niicogarciia/AplicacionGasolineras/src/app/services/favoritos.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { GasolineraSimplificada } from '../models/gasolinera.model';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FavoritosService {\n  private readonly STORAGE_KEY = 'gasolineras_favoritos';\n  private favoritos$ = new BehaviorSubject<GasolineraSimplificada[]>(this.cargarDelStorage());\n\n  constructor() {}\n\n  /**\n   * Obtiene los favoritos como Observable\n   */\n  getFavoritos(): Observable<GasolineraSimplificada[]> {\n    return this.favoritos$.asObservable();\n  }\n\n  /**\n   * Obtiene los favoritos actuales de forma síncrona\n   */\n  getFavoritosActuales(): GasolineraSimplificada[] {\n    return this.favoritos$.value;\n  }\n\n  /**\n   * Agrega una gasolinera a favoritos\n   */\n  agregarFavorito(gasolinera: GasolineraSimplificada): void {\n    const favoritos = this.favoritos$.value;\n    if (!this.esFavorito(gasolinera.id)) {\n      const nuevosFavoritos = [...favoritos, gasolinera];\n      this.favoritos$.next(nuevosFavoritos);\n      this.guardarEnStorage(nuevosFavoritos);\n    }\n  }\n\n  /**\n   * Elimina una gasolinera de favoritos\n   */\n  eliminarFavorito(id: string): void {\n    const favoritos = this.favoritos$.value.filter(g => g.id !== id);\n    this.favoritos$.next(favoritos);\n    this.guardarEnStorage(favoritos);\n  }\n\n  /**\n   * Verifica si una gasolinera está en favoritos\n   */\n  esFavorito(id: string): boolean {\n    return this.favoritos$.value.some(g => g.id === id);\n  }\n\n  /**\n   * Alterna el estado de favorito\n   */\n  toggleFavorito(gasolinera: GasolineraSimplificada): void {\n    if (this.esFavorito(gasolinera.id)) {\n      this.eliminarFavorito(gasolinera.id);\n    } else {\n      this.agregarFavorito(gasolinera);\n    }\n  }\n\n  /**\n   * Limpia todos los favoritos\n   */\n  limpiarFavoritos(): void {\n    this.favoritos$.next([]);\n    localStorage.removeItem(this.STORAGE_KEY);\n  }\n\n  /**\n   * Carga los favoritos del localStorage\n   */\n  private cargarDelStorage(): GasolineraSimplificada[] {\n    try {\n      const data = localStorage.getItem(this.STORAGE_KEY);\n      return data ? JSON.parse(data) : [];\n    } catch (error) {\n      console.error('Error al cargar favoritos del storage:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Guarda los favoritos en localStorage\n   */\n  private guardarEnStorage(favoritos: GasolineraSimplificada[]): void {\n    try {\n      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(favoritos));\n    } catch (error) {\n      console.error('Error al guardar favoritos en storage:', error);\n    }\n  }\n}\n"],"mappings":"AACA,SAASA,eAAe,QAAoB,MAAM;;AAMlD,OAAM,MAAOC,gBAAgB;EAI3BC,YAAA;IAHiB,KAAAC,WAAW,GAAG,uBAAuB;IAC9C,KAAAC,UAAU,GAAG,IAAIJ,eAAe,CAA2B,IAAI,CAACK,gBAAgB,EAAE,CAAC;EAE5E;EAEf;;;EAGAC,YAAYA,CAAA;IACV,OAAO,IAAI,CAACF,UAAU,CAACG,YAAY,EAAE;EACvC;EAEA;;;EAGAC,oBAAoBA,CAAA;IAClB,OAAO,IAAI,CAACJ,UAAU,CAACK,KAAK;EAC9B;EAEA;;;EAGAC,eAAeA,CAACC,UAAkC;IAChD,MAAMC,SAAS,GAAG,IAAI,CAACR,UAAU,CAACK,KAAK;IACvC,IAAI,CAAC,IAAI,CAACI,UAAU,CAACF,UAAU,CAACG,EAAE,CAAC,EAAE;MACnC,MAAMC,eAAe,GAAG,CAAC,GAAGH,SAAS,EAAED,UAAU,CAAC;MAClD,IAAI,CAACP,UAAU,CAACY,IAAI,CAACD,eAAe,CAAC;MACrC,IAAI,CAACE,gBAAgB,CAACF,eAAe,CAAC;;EAE1C;EAEA;;;EAGAG,gBAAgBA,CAACJ,EAAU;IACzB,MAAMF,SAAS,GAAG,IAAI,CAACR,UAAU,CAACK,KAAK,CAACU,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACN,EAAE,KAAKA,EAAE,CAAC;IAChE,IAAI,CAACV,UAAU,CAACY,IAAI,CAACJ,SAAS,CAAC;IAC/B,IAAI,CAACK,gBAAgB,CAACL,SAAS,CAAC;EAClC;EAEA;;;EAGAC,UAAUA,CAACC,EAAU;IACnB,OAAO,IAAI,CAACV,UAAU,CAACK,KAAK,CAACY,IAAI,CAACD,CAAC,IAAIA,CAAC,CAACN,EAAE,KAAKA,EAAE,CAAC;EACrD;EAEA;;;EAGAQ,cAAcA,CAACX,UAAkC;IAC/C,IAAI,IAAI,CAACE,UAAU,CAACF,UAAU,CAACG,EAAE,CAAC,EAAE;MAClC,IAAI,CAACI,gBAAgB,CAACP,UAAU,CAACG,EAAE,CAAC;KACrC,MAAM;MACL,IAAI,CAACJ,eAAe,CAACC,UAAU,CAAC;;EAEpC;EAEA;;;EAGAY,gBAAgBA,CAAA;IACd,IAAI,CAACnB,UAAU,CAACY,IAAI,CAAC,EAAE,CAAC;IACxBQ,YAAY,CAACC,UAAU,CAAC,IAAI,CAACtB,WAAW,CAAC;EAC3C;EAEA;;;EAGQE,gBAAgBA,CAAA;IACtB,IAAI;MACF,MAAMqB,IAAI,GAAGF,YAAY,CAACG,OAAO,CAAC,IAAI,CAACxB,WAAW,CAAC;MACnD,OAAOuB,IAAI,GAAGE,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,GAAG,EAAE;KACpC,CAAC,OAAOI,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,wCAAwC,EAAEA,KAAK,CAAC;MAC9D,OAAO,EAAE;;EAEb;EAEA;;;EAGQb,gBAAgBA,CAACL,SAAmC;IAC1D,IAAI;MACFY,YAAY,CAACQ,OAAO,CAAC,IAAI,CAAC7B,WAAW,EAAEyB,IAAI,CAACK,SAAS,CAACrB,SAAS,CAAC,CAAC;KAClE,CAAC,OAAOkB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,wCAAwC,EAAEA,KAAK,CAAC;;EAElE;;;uBAzFW7B,gBAAgB;IAAA;EAAA;;;aAAhBA,gBAAgB;MAAAiC,OAAA,EAAhBjC,gBAAgB,CAAAkC,IAAA;MAAAC,UAAA,EAFf;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}